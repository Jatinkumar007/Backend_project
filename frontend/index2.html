<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./index.css">
</head>
<body>
    <div>
        <div class="first">
            <h1>Instagram SignUp</h1>
        </div>
        <div class="second">
            <form action="/login">
                <label>Username</label><br>
                <input type="text" id="username" name="username" placeholder="Enter Your Username"><br><br>
                <label>Password</label><br>
                <input type="text" id="password" name="password" placeholder="Enter Your Password"><br><br>
                <input class="submit" id="sub2" type="submit" value="Log In">
            </form>
        </div>
        <div class="third">
            <p>Forget Password?</p><a href="./index.html">SignUp</a>
        </div>
    </div>
</body>
<script>
    const formLogin=document.getElementById('sub2');
    formLogin.addEventListener("click",(event)=>{
        event.preventDefault();

        const userName=document.getElementById('username').value;
        const userPassword=document.getElementById('password').value;
        if(!userName || !userPassword){
            alert("All Fields are required")
            return
        }
        const userData={
            username:userName,
            password:userPassword
        }
        loginUser(userData)
    })
    const loginUser=async(data2)=>{
        try {

const resp = await fetch("http://localhost:8001/login",{
  method:"POST",
  credentials: 'include',
redirect: 'follow',
  headers:{"content-type":"application/json"},
  body:JSON.stringify(data2)
})

const data = await resp.json();
const token=data.token;
window.location.href=`http://127.0.0.1:5500/frontend/index3.html?token=${token}`;

} catch (error) {
console.log(error.message)
}
    }
</script>
</html>